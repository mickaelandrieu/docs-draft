# Running Test Suite

Both projects have a set of Unit, Functional and Behavioral tests. It is important
to know how to run them all, and how to do that in a fast way

## elcodi/elcodi

Running the test suite for elcodi/elcodi is simply one command:

``` bash
php bin/phpunit
```

Elcodi tests are ran against folder `/tmp/Elcodi`, so a good practice in this
case is to ensure that accesses to this folder are fast enough. For this reason, we can
create a `tmpfs`, a mounted file system stored in volatile memory instead of a 
persistent storage device.

``` bash
rm -Rf /tmp/Elcodi
sudo mkdir /tmp/Elcodi
sudo mount -t tmpfs -o size=512M tmpfs /tmp/Elcodi/
```

With this trick, your tests will run extremely faster than before.

Elcodi project uses as well a Testing Booster called
[FixturesBoosterBundle](https://github.com/elcodi/FixturesBoosterBundle). This
project overwrites the Doctrine command `doctrine:fixtures:load` with a boosted
version.

In order to avoid keeping state on a temporal database you may need to remove 
temporal files generated by this booster on your tmp folder:

``` bash
rm -rf /tmp/*.backup.database
```

In addition to this it is required to flush the redis database:

``` bash
redis-cli flushall
```

Problems can turn very cryptic if you are using an expired redis database.

## elcodi/bamboo

Running the test suite for elcodi/bamboo is also simple:

``` bash
php bin/behat
php bin/phpunit -c app/
```

As explained before, Bamboo tests also can be ran against a `tmpfs` unit.

``` bash
rm -Rf /tmp/Bamboo
sudo mkdir /tmp/Bamboo
sudo mount -t tmpfs -o size=512M tmpfs /tmp/Bamboo
```

You can do the same with the cache folder, in order to make all reads really 
faster.

``` bash
rm -Rf app/cache
mkdir app/cache
sudo mkdir /tmp/Bamboo
sudo mount -t tmpfs -o size=512M tmpfs /tmp/cache
```

If you want to run a subset of the behat tests you can specify the tag as
an option:

``` bash
php bin/behat --tags="store"
```

This will only run the feature scenarios tagged with @store, e.g.:

``` gherkin
# bamboo/features/store/cart.feature
@store @cart
Feature: Store cart
  In order to use the cart
  As a visitor or logged user
  I need to be able to add products into it and access the checkout

  # ...
```

A typical use case when to use this feature is when you want to
run only the tests that require javascript.
